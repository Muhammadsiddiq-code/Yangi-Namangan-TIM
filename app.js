        // Translations
        const translations = {
            uz: {
              'title': 'PIIMA - Iqtisoslashtirilgan Ta\'lim Muassasalari Agentligi',
              'nav-about': 'Raxbariyat',
              'nav-leadership': 'Maktab haqida',
              'nav-structure': 'Tashkiliy tuzilma',
              'nav-duties': 'Vazifa va funksiyalar',
              'nav-documents': 'Hujjatlar',
              'nav-laws': 'Qonunlar',
              'nav-decisions': 'Qarorlar',
              'nav-regulations': 'Nizomlar',
              'nav-activity': 'Faoliyat',
              'nav-youth': 'Yoshlar siyosati',
              'nav-news': 'Axborot xizmati',
              'nav-news-list': 'Yangiliklar',
              'nav-announcements': 'E\'lonlar',
              'nav-media': 'Media',
              'nav-opendata': 'Ochiq ma\'lumotlar',
              'nav-contact': 'Bog\'lanish',
              'search-placeholder': 'Qidirish...',
              'stat-president': 'Prezident maktablarda',
              'stat-creative': 'Ijod maktablarida',
              'stat-specialized': 'Ixtisoslashgan maktablarda',
              'stat-participants': 'Olimpiada qatnashganlar',
              'stat-winners': 'Olimpiada g\'oliblari',
              'stat-students': 'nafar o\'quvchilar',
              'news-title': 'So\'nggi yangiliklar',
              'news-all': 'Barcha yangiliklar',
              'news1-title': 'Yangi Namangan tumani Ixtisoslashgan maktab.',
              'news1-content': 'Yangi Namangan tumani Ixtisoslashgan maktabning 10-sinf o\'quvchisi Botirsherov Abdulatif Bilim va malakalarni baholash agentligi tomonidan o\'tkazilgan chet tilini bilish darajasi sinovida (ingliz tili) ishtirok etib C1 darajasini qo\'lga kiritdi.',
              'news2-title': 'Yangi Namangan tumani Ixtisoslashgan maktab.',
              'news2-content': 'Maktabimizning 7-01-sinf o\'quvchisi Kamolboyeva Gulsanam Bilim va malakalarni baholash agentligi tomonidan o\'tkazilgan chet tilini bilish darajasi sinovida (ingliz tili) ishtirok etib B2 darajasini qo\'lga kiritdi.',
              'news3-title': 'Yangi Namangan tumani Ixtisoslashgan maktab.',
              'news3-content': 'Maktabimizning 7-01 sinf o\'quvchisi Muradullayev Zikrullo IELTS imtihonini muvafaqqiyatli topshirib 6.5 ball egasiga aylandi. Zikrullo hali yosh bo\'lishiga qaramay, o\'z oldiga ulkan marralarni qo\'ygan o\'quvchilarimizdan biri hisoblanadi.',
              'read-more': 'Batafsil',
              'schools-title': 'Bizning maktablar',
              'school1-title': 'Prezident maktablari',
              'school1-desc': 'Iqtidorli o\'quvchilar uchun zamonaviy ta\'lim standartlari asosida faoliyat yurituvchi maktablar.',
              'school2-title': 'Ijod maktablari',
              'school2-desc': 'San\'at va madaniyat sohasida iqtidorli yoshlarni qo\'llab-quvvatlash uchun tashkil etilgan maktablar.',
              'school3-title': 'Ixtisoslashgan maktablar',
              'school3-desc': 'Aniq va tabiiy fanlar bo\'yicha chuqurlashtirilgan ta\'lim beruvchi maktablar.',
              'events-title': 'Tadbirlar va e\'lonlar',
              'events-all': 'Barcha tadbirlar',
              'event1-title': 'Ochiq eshiklar kuni',
              'event1-location': 'Yangi Namangan tumani',
              'event1-desc': 'Bugun eshiklarimiz siz uchun ochiq! Ta\'lim maskanimiz bilan yaqindan tanishing, biz bilan kelajak sari birga yuring!',
              'event2-title': 'Maktab bitiruv kuni',
              'event2-location': 'Barcha maktablarda',
              'event2-desc': 'Barcha maktablarida bitiruv kuni 23-May kuni deb e\'lon qilindi. Hamma maktablada bitiruv 23-May kuni bo\'ladi',
              'event3-title': 'Xalqaro bolalar kuni',
              'event3-location': 'Respublika bo\'ylab',
              'event3-desc': 'Xalqaro bolalar kuniga bag\'ishlangan tadbirlar barcha ixtisoslashgan maktablarda tashkil etiladi.',
              'footer-title1': 'IXTISOSLASHTIRILGAN',
              'footer-title2': 'TA\'LIM MUASSASALARI',
              'footer-title3': 'AGENTLIGI MAKTABI',
              'footer-schedule': 'Ish grafigi va O\'qish grafigi:',
              'footer-workdays': 'Dushanba – juma: 8:30 – 17:30',
              'footer-lunch': 'Tushlik: 13:00 – 14:00',
              'footer-weekend': 'Dam olish kunlari: shanba va yakshanba',
              'footer-terms': 'Ma\'lumotdan foydalanish shartlari',
              'footer-bank': 'Bank rekvizitlari',
              'footer-copyright': 'Materialdan to\'liq yoki qisman foydalanilganda, piima.uz manbasi ko\'rsatilishi shart.',
              'footer-contact': 'Aloqa ma\'lumotlari:',
              'footer-address': 'Namnagan shaxri Yangi Namangan tumani',
              'footer-trust': 'Ishonch telefoni:',
              'footer-question': 'Savol yo\'llash',
              'footer-email': 'Pochtangizni kiriting',
              'footer-subscribe': 'Obuna bo\'lish',
              'footer-facebook': '"Facebook"dagi sahifa',
              'footer-telegram': '"Telegram"dagi kanal',
              'footer-feedback': 'Qayta aloqa',
              'footer-instagram': '"Instagram"dagi kanal',
              'footer-youtube': '"Youtube"dagi kanal',
              'notification-text': 'Bizga xabar yuboring',
              'modal-title': 'Savol yo\'llash',
              'modal-name': 'Ismingiz:',
              'modal-email': 'Email:',
              'modal-phone': 'Telefon raqamingiz:',
              'modal-message': 'Xabaringiz:',
              'modal-agree': 'Shaxsiy ma\'lumotlarni qayta ishlashga roziman',
              'modal-send': 'Telegram botga yuborish',
              'subscribe-title': 'Yangiliklarimizga obuna bo\'ling',
              'toast-success': 'Muvaffaqiyatli yuborildi!',
              'cookie-text': 'Ushbu sayt cookie-fayllardan foydalanadi. Saytdan foydalanishni davom ettirish orqali siz cookie-fayllardan foydalanishga rozilik bildirasiz.',
              'cookie-accept': 'Qabul qilish'
            },
            ru: {
              'title': 'ПИИМА - Агентство специализированных образовательных учреждений',
              'nav-about': 'Об агентстве',
              'nav-leadership': 'Руководство',
              'nav-structure': 'Организационная структура',
              'nav-duties': 'Задачи и функции',
              'nav-documents': 'Документы',
              'nav-laws': 'Законы',
              'nav-decisions': 'Решения',
              'nav-regulations': 'Положения',
              'nav-activity': 'Деятельность',
              'nav-youth': 'Молодежная политика',
              'nav-news': 'Информационная служба',
              'nav-news-list': 'Новости',
              'nav-announcements': 'Объявления',
              'nav-media': 'Медиа',
              'nav-opendata': 'Открытые данные',
              'nav-contact': 'Контакты',
              'search-placeholder': 'Поиск...',
              'stat-president': 'В президентских школах',
              'stat-creative': 'В творческих школах',
              'stat-specialized': 'В специализированных школах',
              'stat-participants': 'Участники олимпиад',
              'stat-winners': 'Победители олимпиад',
              'stat-students': 'учеников',
              'news-title': 'Последние новости',
              'news-all': 'Все новости',
              'news1-title': 'Специализированная школа Янги Наманганского района.',
              'news1-content': 'Ученик 10 класса специализированной школы Янги Наманганского района Ботиршеров Абдулатиф принял участие в тестировании уровня знания иностранного языка (английский язык), проводимом Агентством оценки знаний и навыков, и получил уровень C1.',
              'news2-title': 'Специализированная школа Янги Наманганского района.',
              'news2-content': 'Ученица 7-01 класса нашей школы Камолбоева Гульсанам приняла участие в тестировании уровня знания иностранного языка (английский язык), проводимом Агентством оценки знаний и навыков, и получила уровень B2.',
              'news3-title': 'Специализированная школа Янги Наманганского района.',
              'news3-content': 'Ученик 7-01 класса нашей школы Мурадуллаев Зикрулло успешно сдал экзамен IELTS и получил 6.5 баллов. Зикрулло, несмотря на свой юный возраст, является одним из наших учеников, поставивших перед собой большие цели.',
              'read-more': 'Подробнее',
              'schools-title': 'Наши школы',
              'school1-title': 'Президентские школы',
              'school1-desc': 'Школы, работающие на основе современных образовательных стандартов для талантливых учеников.',
              'school2-title': 'Творческие школы',
              'school2-desc': 'Школы, созданные для поддержки талантливой молодежи в области искусства и культуры.',
              'school3-title': 'Специализированные школы',
              'school3-desc': 'Школы, обеспечивающие углубленное образование по точным и естественным наукам.',
              'events-title': 'Мероприятия и объявления',
              'events-all': 'Все мероприятия',
              'event1-title': 'День открытых дверей',
              'event1-location': 'Янги Наманганский район',
              'event1-desc': 'Сегодня наши двери открыты для вас! Познакомьтесь поближе с нашим образовательным учреждением, идите с нами в будущее!',
              'event2-title': 'День выпуска школы',
              'event2-location': 'Во всех школах',
              'event2-desc': 'День выпуска во всех школах объявлен на 23 мая. Выпуск во всех школах состоится 23 мая',
              'event3-title': 'Международный день детей',
              'event3-location': 'По всей республике',
              'event3-desc': 'Мероприятия, посвященные Международному дню детей, будут организованы во всех специализированных школах.',
              'footer-title1': 'СПЕЦИАЛИЗИРОВАННЫХ',
              'footer-title2': 'ОБРАЗОВАТЕЛЬНЫХ УЧРЕЖДЕНИЙ',
              'footer-title3': 'АГЕНТСТВО ШКОЛЫ',
              'footer-schedule': 'График работы и учебы:',
              'footer-workdays': 'Понедельник – пятница: 8:30 – 17:30',
              'footer-lunch': 'Обед: 13:00 – 14:00',
              'footer-weekend': 'Выходные дни: суббота и воскресенье',
              'footer-terms': 'Условия использования информации',
              'footer-bank': 'Банковские реквизиты',
              'footer-copyright': 'При полном или частичном использовании материала обязательно указание источника piima.uz.',
              'footer-contact': 'Контактная информация:',
              'footer-address': 'г. Наманган, Янги Наманганский район',
              'footer-trust': 'Телефон доверия:',
              'footer-question': 'Отправить вопрос',
              'footer-email': 'Введите ваш email',
              'footer-subscribe': 'Подписаться',
              'footer-facebook': 'Страница в "Facebook"',
              'footer-telegram': 'Канал в "Telegram"',
              'footer-feedback': 'Обратная связь',
              'footer-instagram': 'Канал в "Instagram"',
              'footer-youtube': 'Канал в "Youtube"',
              'notification-text': 'Отправьте нам сообщение',
              'modal-title': 'Отправить вопрос',
              'modal-name': 'Ваше имя:',
              'modal-email': 'Email:',
              'modal-phone': 'Ваш номер телефона:',
              'modal-message': 'Ваше сообщение:',
              'modal-agree': 'Согласен на обработку персональных данных',
              'modal-send': 'Отправить в Telegram бот',
              'subscribe-title': 'Подпишитесь на наши новости',
              'toast-success': 'Успешно отправлено!',
              'cookie-text': 'Этот сайт использует файлы cookie. Продолжая использовать сайт, вы соглашаетесь на использование файлов cookie.',
              'cookie-accept': 'Принять'
            },
            en: {
              'title': 'PIIMA - Agency of Specialized Educational Institutions',
              'nav-about': 'About Agency',
              'nav-leadership': 'Leadership',
              'nav-structure': 'Organizational Structure',
              'nav-duties': 'Duties and Functions',
              'nav-documents': 'Documents',
              'nav-laws': 'Laws',
              'nav-decisions': 'Decisions',
              'nav-regulations': 'Regulations',
              'nav-activity': 'Activity',
              'nav-youth': 'Youth Policy',
              'nav-news': 'Information Service',
              'nav-news-list': 'News',
              'nav-announcements': 'Announcements',
              'nav-media': 'Media',
              'nav-opendata': 'Open Data',
              'nav-contact': 'Contact',
              'search-placeholder': 'Search...',
              'stat-president': 'In Presidential Schools',
              'stat-creative': 'In Creative Schools',
              'stat-specialized': 'In Specialized Schools',
              'stat-participants': 'Olympiad Participants',
              'stat-winners': 'Olympiad Winners',
              'stat-students': 'students',
              'news-title': 'Latest News',
              'news-all': 'All News',
              'news1-title': 'Yangi Namangan District Specialized School.',
              'news1-content': '10th grade student of Yangi Namangan District Specialized School Botirsherov Abdulatif participated in the foreign language proficiency test (English) conducted by the Knowledge and Skills Assessment Agency and achieved C1 level.',
              'news2-title': 'Yangi Namangan District Specialized School.',
              'news2-content': '7-01 grade student of our school Kamolboyeva Gulsanam participated in the foreign language proficiency test (English) conducted by the Knowledge and Skills Assessment Agency and achieved B2 level.',
              'news3-title': 'Yangi Namangan District Specialized School.',
              'news3-content': '7-01 grade student of our school Muradullayev Zikrullo successfully passed the IELTS exam and scored 6.5 points. Despite his young age, Zikrullo is one of our students who has set great goals for himself.',
              'read-more': 'Read More',
              'schools-title': 'Our Schools',
              'school1-title': 'Presidential Schools',
              'school1-desc': 'Schools operating on the basis of modern educational standards for talented students.',
              'school2-title': 'Creative Schools',
              'school2-desc': 'Schools established to support talented youth in the field of arts and culture.',
              'school3-title': 'Specialized Schools',
              'school3-desc': 'Schools providing in-depth education in exact and natural sciences.',
              'events-title': 'Events and Announcements',
              'events-all': 'All Events',
              'event1-title': 'Open Doors Day',
              'event1-location': 'Yangi Namangan District',
              'event1-desc': 'Today our doors are open for you! Get acquainted with our educational institution, go to the future with us!',
              'event2-title': 'School Graduation Day',
              'event2-location': 'In all schools',
              'event2-desc': 'Graduation day in all schools is announced for May 23. Graduation in all schools will be on May 23',
              'event3-title': 'International Children\'s Day',
              'event3-location': 'Throughout the republic',
              'event3-desc': 'Events dedicated to International Children\'s Day will be organized in all specialized schools.',
              'footer-title1': 'SPECIALIZED',
              'footer-title2': 'EDUCATIONAL INSTITUTIONS',
              'footer-title3': 'AGENCY SCHOOL',
              'footer-schedule': 'Work and Study Schedule:',
              'footer-workdays': 'Monday – Friday: 8:30 – 17:30',
              'footer-lunch': 'Lunch: 13:00 – 14:00',
              'footer-weekend': 'Weekends: Saturday and Sunday',
              'footer-terms': 'Terms of Information Use',
              'footer-bank': 'Bank Details',
              'footer-copyright': 'When using the material in full or in part, it is mandatory to indicate the source piima.uz.',
              'footer-contact': 'Contact Information:',
              'footer-address': 'Namangan city, Yangi Namangan district',
              'footer-trust': 'Trust Phone:',
              'footer-question': 'Send Question',
              'footer-email': 'Enter your email',
              'footer-subscribe': 'Subscribe',
              'footer-facebook': '"Facebook" page',
              'footer-telegram': '"Telegram" channel',
              'footer-feedback': 'Feedback',
              'footer-instagram': '"Instagram" channel',
              'footer-youtube': '"Youtube" channel',
              'notification-text': 'Send us a message',
              'modal-title': 'Send Question',
              'modal-name': 'Your Name:',
              'modal-email': 'Email:',
              'modal-phone': 'Your Phone Number:',
              'modal-message': 'Your Message:',
              'modal-agree': 'I agree to the processing of personal data',
              'modal-send': 'Send to Telegram Bot',
              'subscribe-title': 'Subscribe to Our News',
              'toast-success': 'Successfully sent!',
              'cookie-text': 'This site uses cookies. By continuing to use the site, you consent to the use of cookies.',
              'cookie-accept': 'Accept'
            }
          };
          
          // Current language and theme
          let currentLang = 'uz';
          let isDarkTheme = false;
          
          document.addEventListener("DOMContentLoaded", () => {
            // Initialize theme
            initializeTheme();
            
            // Initialize language
            initializeLanguage();
            
            // Statistika raqamlarini animatsiya qilish
            function animateValue(id, start, end, duration) {
              const obj = document.getElementById(id)
              if (!obj) return
          
              let startTimestamp = null
              const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp
                const progress = Math.min((timestamp - startTimestamp) / duration, 1)
                obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString("en-US")
                if (progress < 1) {
                  window.requestAnimationFrame(step)
                }
              }
              window.requestAnimationFrame(step)
            }
          
            // Statistikalarni animatsiya qilish
            function startCountAnimation() {
              animateValue("stat1", 0, 2352, 2000)
              animateValue("stat2", 0, 1849, 2000)
              animateValue("stat3", 0, 67454, 2000)
              animateValue("stat4", 0, 42970, 2000)
              animateValue("stat5", 0, 150, 2000)
            }
          
            // Sahifa yuklanganda statistikalarni animatsiya qilish
            startCountAnimation()
          
            // Hero slider
            const Swiper = window.Swiper
            if (Swiper) {
              const heroSwiper = new Swiper(".hero-slider", {
                effect: "fade",
                speed: 1000,
                autoplay: {
                  delay: 5000,
                },
                pagination: {
                  el: ".hero-slider .swiper-pagination",
                  clickable: true,
                },
                navigation: {
                  nextEl: ".hero-slider .swiper-button-next",
                  prevEl: ".hero-slider .swiper-button-prev",
                },
              })
          
              // Tadbirlar slider
              const eventsSwiper = new Swiper(".events-slider", {
                slidesPerView: 1,
                spaceBetween: 20,
                pagination: {
                  el: ".events-slider .swiper-pagination",
                  clickable: true,
                },
                breakpoints: {
                  768: {
                    slidesPerView: 2,
                  },
                  992: {
                    slidesPerView: 3,
                  },
                },
              })
            }
          
            // Theme Toggle
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
              themeToggle.addEventListener('click', toggleTheme);
            }
          
            function initializeTheme() {
              const savedTheme = localStorage.getItem('theme');
              if (savedTheme === 'dark') {
                isDarkTheme = true;
                document.documentElement.setAttribute('data-theme', 'dark');
                updateThemeIcon();
              }
            }
          
            function toggleTheme() {
              isDarkTheme = !isDarkTheme;
              if (isDarkTheme) {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
              } else {
                document.documentElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
              }
              updateThemeIcon();
            }
          
            function updateThemeIcon() {
              const themeIcon = themeToggle.querySelector('i');
              if (themeIcon) {
                if (isDarkTheme) {
                  themeIcon.className = 'fas fa-sun';
                } else {
                  themeIcon.className = 'fas fa-moon';
                }
              }
            }
          
            // Language System
            function initializeLanguage() {
              const savedLang = localStorage.getItem('language') || 'uz';
              currentLang = savedLang;
              updateLanguage();
              updateActiveLanguage();
            }
          
            function updateLanguage() {
              const elements = document.querySelectorAll('[data-key]');
              elements.forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[currentLang] && translations[currentLang][key]) {
                  if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translations[currentLang][key];
                  } else {
                    element.textContent = translations[currentLang][key];
                  }
                }
              });
              
              // Update document title
              document.title = translations[currentLang]['title'];
              
              // Update HTML lang attribute
              document.documentElement.lang = currentLang;
            }
          
            function updateActiveLanguage() {
              const languageLinks = document.querySelectorAll('[data-lang]');
              languageLinks.forEach(link => {
                link.classList.toggle('active', link.getAttribute('data-lang') === currentLang);
              });
            }
          
            // Language switching
            const languageLinks = document.querySelectorAll("[data-lang]");
            languageLinks.forEach((link) => {
              link.addEventListener("click", function (e) {
                e.preventDefault();
                const selectedLang = this.getAttribute("data-lang");
                if (selectedLang !== currentLang) {
                  currentLang = selectedLang;
                  updateLanguage();
                  updateActiveLanguage();
                  localStorage.setItem('language', currentLang);
                }
              });
            });
          
            // Scroll effektlari
            window.addEventListener("scroll", () => {
              const header = document.getElementById("main-header")
              if (header) {
                if (window.scrollY > 50) {
                  header.classList.add("scrolled")
          
                  // Menu icon rangini o'zgartirish
                  const menuIconSpans = document.querySelectorAll(".menu-icon span")
                  menuIconSpans.forEach((span) => {
                    span.style.background = isDarkTheme ? "#f9fafb" : "#333"
                  })
                } else {
                  header.classList.remove("scrolled")
          
                  // Menu icon rangini qaytarish
                  const menuIconSpans = document.querySelectorAll(".menu-icon span")
                  menuIconSpans.forEach((span) => {
                    span.style.background = "#fff"
                  })
                }
              }
            })
          
            // Mobil menyu
            const menuIcon = document.getElementById("mobile-menu-toggle")
            const mobileMenu = document.querySelector(".mobile-menu")
          
            if (menuIcon && mobileMenu) {
              menuIcon.addEventListener("click", function () {
                this.classList.toggle("active")
                mobileMenu.classList.toggle("active")
              })
            }
          
            // Qidiruv
            const searchToggle = document.getElementById("search-toggle")
            const searchOverlay = document.querySelector(".search-overlay")
            const closeSearch = document.querySelector(".close-search")
          
            if (searchToggle && searchOverlay) {
              searchToggle.addEventListener("click", (e) => {
                e.preventDefault()
                searchOverlay.classList.add("active")
                const searchInput = document.querySelector(".search-container input")
                if (searchInput) {
                  searchInput.focus()
                }
              })
            }
          
            if (closeSearch && searchOverlay) {
              closeSearch.addEventListener("click", () => {
                searchOverlay.classList.remove("active")
              })
            }
          
            // Esc tugmasi bosilganda qidiruv oynasini yopish
            document.addEventListener("keydown", (e) => {
              if (e.key === "Escape" && searchOverlay && searchOverlay.classList.contains("active")) {
                searchOverlay.classList.remove("active")
              }
            })
          
            // Scroll down tugmasi
            const scrollDownBtn = document.querySelector(".scroll-down a")
            if (scrollDownBtn) {
              scrollDownBtn.addEventListener("click", function (e) {
                e.preventDefault()
                const targetId = this.getAttribute("href")
                const targetElement = document.querySelector(targetId)
          
                if (targetElement) {
                  window.scrollTo({
                    top: targetElement.offsetTop,
                    behavior: "smooth",
                  })
                }
              })
            }
          
            // Cookie notice
            const cookieNotice = document.getElementById("cookie-notice")
            const acceptCookiesBtn = document.getElementById("accept-cookies")
          
            // Cookie-ni tekshirish
            if (cookieNotice && !localStorage.getItem("cookiesAccepted")) {
              cookieNotice.style.display = "block"
            }
          
            if (acceptCookiesBtn && cookieNotice) {
              acceptCookiesBtn.addEventListener("click", () => {
                localStorage.setItem("cookiesAccepted", "true")
                cookieNotice.style.display = "none"
              })
            }
          
            // Modal functionality
            const contactBtn = document.getElementById("contactBtn");
            const emailBtn = document.getElementById("emailBtn");
            const subscribeBtn = document.getElementById("subscribeBtn");
            const contactModal = document.getElementById("contactModal");
            const subscribeModal = document.getElementById("subscribeModal");
            const closeModal = document.getElementById("closeModal");
            const closeSubscribeModal = document.getElementById("closeSubscribeModal");
            const notificationBar = document.getElementById("notificationBar");
            const closeNotification = document.getElementById("closeNotification");
            const contactForm = document.getElementById("contactForm");
            const subscribeForm = document.getElementById("subscribeForm");
            const toast = document.getElementById("toast");
          
            // Telegram bot settings
            const TELEGRAM_BOT_TOKEN = "7012510583:AAEjIGP-LqL75etZYOEBnvRFy_K5VAmQw3c";
            const TELEGRAM_CHAT_ID = "7116193043";
          
            // Show modals
            if (contactBtn && contactModal) {
              contactBtn.addEventListener("click", () => {
                contactModal.style.display = "block";
                document.body.style.overflow = "hidden";
              });
            }
          
            if (emailBtn && subscribeModal) {
              emailBtn.addEventListener("click", () => {
                subscribeModal.style.display = "block";
                document.body.style.overflow = "hidden";
              });
            }
          
            if (subscribeBtn && subscribeModal) {
              subscribeBtn.addEventListener("click", () => {
                subscribeModal.style.display = "block";
                document.body.style.overflow = "hidden";
              });
            }
          
            if (notificationBar && contactModal && closeNotification) {
              notificationBar.addEventListener("click", (e) => {
                if (e.target !== closeNotification) {
                  contactModal.style.display = "block";
                  document.body.style.overflow = "hidden";
                }
              });
            }
          
            // Close modals
            if (closeModal && contactModal) {
              closeModal.addEventListener("click", () => {
                contactModal.style.display = "none";
                document.body.style.overflow = "auto";
              });
            }
          
            if (closeSubscribeModal && subscribeModal) {
              closeSubscribeModal.addEventListener("click", () => {
                subscribeModal.style.display = "none";
                document.body.style.overflow = "auto";
              });
            }
          
            if (closeNotification && notificationBar) {
              closeNotification.addEventListener("click", (e) => {
                e.stopPropagation();
                notificationBar.style.display = "none";
              });
            }
          
            // Close modals when clicking outside
            window.addEventListener("click", (e) => {
              if (contactModal && e.target === contactModal) {
                contactModal.style.display = "none";
                document.body.style.overflow = "auto";
              }
              if (subscribeModal && e.target === subscribeModal) {
                subscribeModal.style.display = "none";
                document.body.style.overflow = "auto";
              }
            });
          
            // Form submissions
            if (contactForm) {
              contactForm.addEventListener("submit", (e) => {
                e.preventDefault();
          
                const nameInput = document.getElementById("name");
                const emailInput = document.getElementById("email");
                const messageInput = document.getElementById("message");
                const phoneInput = document.getElementById("phone");
          
                if (nameInput && emailInput && messageInput) {
                  const name = nameInput.value;
                  const email = emailInput.value;
                  const message = messageInput.value;
                  const phone = phoneInput ? phoneInput.value : '';
          
                  sendToTelegramBot(name, email, phone, message)
                    .then((success) => {
                      if (success) {
                        contactForm.reset();
                        if (contactModal) {
                          contactModal.style.display = "none";
                          document.body.style.overflow = "auto";
                        }
                        showToast(translations[currentLang]['toast-success']);
                      } else {
                        showToast("Xatolik yuz berdi. Iltimos, qaytadan urinib ko'ring.");
                      }
                    })
                    .catch((error) => {
                      console.error("Error sending to Telegram:", error);
                      showToast("Xatolik yuz berdi. Iltimos, qaytadan urinib ko'ring.");
                    });
                }
              });
            }
          
            async function sendToTelegramBot(name, email, phone, message) {
              try {
                const text = `📨 Yangi savol:\n\n👤 Ism: ${name}\n📧 Email: ${email}\n📱 Telefon: ${phone || "Ko'rsatilmagan"}\n\n💬 Xabar:\n${message}`;
                const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
          
                const response = await fetch(url, {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: text,
                    parse_mode: "HTML",
                  }),
                });
          
                const data = await response.json();
                return data.ok === true;
              } catch (error) {
                console.error("Error sending to Telegram:", error);
                return false;
              }
            }
          
            if (subscribeForm) {
              subscribeForm.addEventListener("submit", (e) => {
                e.preventDefault();
                const subscriberEmailInput = document.getElementById("subscriberEmail");
                if (subscriberEmailInput) {
                  const email = subscriberEmailInput.value;
                  console.log("Subscribe Form Submitted:", { email });
                  subscribeForm.reset();
                  if (subscribeModal) {
                    subscribeModal.style.display = "none";
                    document.body.style.overflow = "auto";
                  }
                  showToast("Siz muvaffaqiyatli obuna bo'ldingiz!");
                }
              });
            }
          
            function showToast(message) {
              if (toast) {
                const toastMessage = document.getElementById("toast-message");
                if (toastMessage) {
                  toastMessage.textContent = message;
                }
                toast.style.transform = "translateX(-50%) translateY(0)";
                toast.style.opacity = "1";
                setTimeout(() => {
                  toast.style.transform = "translateX(-50%) translateY(100px)";
                  toast.style.opacity = "0";
                }, 3000);
              }
            }
          
            // Responsive design for footer
            function adjustFooterLayout() {
              const footer = document.querySelector('footer > div:last-child > div');
              if (footer && window.innerWidth <= 768) {
                footer.style.gridTemplateColumns = '1fr';
                footer.style.gap = '30px';
              } else if (footer) {
                footer.style.gridTemplateColumns = '1fr 1fr 1fr';
                footer.style.gap = '40px';
              }
            }
          
            window.addEventListener('resize', adjustFooterLayout);
            adjustFooterLayout();
          });
          

          // chat bot





          // AI Chat Widget for PIIMA
class PIIMAChatWidget {
  constructor() {
    this.currentLang = "uz"
    this.isOpen = false
    this.isMinimized = false
    this.messageHistory = []

    this.translations = {
      uz: {
        "chat-title": "  ixtisoslasjtirilgan maktab AI ",
        "chat-status": "Onlayn",
        "chat-placeholder": "Savolingizni yozing...",
        "quick-about": "Maktab haqida",
        "quick-admission": "Qabul",
        "quick-contact": "Aloqa",
        "welcome-message": "Salom! Men PIIMA maktabining AI yordamchisiman. Sizga qanday yordam bera olaman?",
        typing: "Yozmoqda...",
      },
      ru: {
        "chat-title": "ПИИМА AI Помощник",
        "chat-status": "Онлайн",
        "chat-placeholder": "Напишите ваш вопрос...",
        "quick-about": "О школе",
        "quick-admission": "Поступление",
        "quick-contact": "Контакты",
        "welcome-message": "Привет! Я AI помощник школы ПИИМА. Как я могу вам помочь?",
        typing: "Печатает...",
      },
      en: {
        "chat-title": "PIIMA AI Assistant",
        "chat-status": "Online",
        "chat-placeholder": "Type your question...",
        "quick-about": "About School",
        "quick-admission": "Admission",
        "quick-contact": "Contact",
        "welcome-message": "Hello! I am PIIMA school's AI assistant. How can I help you?",
        typing: "Typing...",
      },
    }

    this.responses = {
      uz: {
        salom: "Salom! Yangi Namangan Ixtisoslashtirilgan maktabiga xush kelibsiz! 🎓",
        "maktab haqida":
          "Yangi Namangan tumani - Iqtisoslashtirilgan Ta'lim Muassasalari Agentligi maktabi. Biz iqtidorli o'quvchilar uchun yuqori sifatli ta'lim beramiz. 📚\n\n🏫 Bizda:\n• Prezident maktablari\n• Ijod maktablari  \n• Ixtisoslashgan maktablar\n\nBatafsil ma'lumot uchun saytimizni ko'ring!",
        qabul:
          "Qabul jarayoni haqida ma'lumot:\n\n📅 Qabul muddati: Har yili may-iyun oylari\n📝 Kerakli hujjatlar:\n• Ariza\n• Pasport nusxasi yoki metirka\n• Diplom/attestat\n• Tibbiy ma'lumotnoma\n\n📞 Qo'shimcha ma'lumot: +998 97 827 55 77",
        "bog'lanish":
          "Bizning aloqa ma'lumotlari:\n\n📍 Manzil: Namangan shahar, Yangi Namangan tumani\n📞 Telefon: +998 97 827 55 77\n📧 Telegram: https://t.me/YangiNamanganTIM\n🌐 Sayt: https://yntimuz.vercel.app\n\n🕒 Ish vaqti: Dushanbadan-Jumagacha 8:30-17:30",
        fanlar:
          "Bizda quyidagi fanlar bo'yicha chuqurlashtirilgan ta'lim beriladi:\n\n🔬 Aniq fanlar:\n• Algebra\n• Fizika\n• Geometriya\n• English\n\n💻 Zamonaviy fanlar:\n• Informatika\n• Robotika\n• IT texnologiyalar",
        imtiyozlar:
          "Bizning maktab imtiyozlari:\n\n🏆 Yuqori sifatli ta'lim\n🌟 Malakali o'qituvchilar\n💻 Zamonaviy jihozlar\n🎯 Individual yondashuv\n🏅 Olimpiada tayyorlash\n🌍 Xalqaro aloqalar",
        default:
          "Kechirasiz, bu savolga aniq javob bera olmadim. 😔\n\nQo'shimcha ma'lumot uchun:\n📞 +998 97 827 55 77\n📧 info@piima.uz\n\nYoki boshqa savol bering! 😊",
      },
      ru: {
        привет: "Привет! Добро пожаловать в школу ПИИМА! 🎓",
        "о школе":
          "ПИИМА - Агентство специализированных образовательных учреждений. Мы предоставляем качественное образование для талантливых учеников. 📚\n\n🏫 У нас есть:\n• Президентские школы\n• Творческие школы\n• Специализированные школы\n\nПодробная информация на нашем сайте!",
        поступление:
          "Информация о поступлении:\n\n📅 Сроки приема: Май-июнь каждого года\n📝 Необходимые документы:\n• Заявление\n• Копия паспорта\n• Диплом/аттестат\n• Медицинская справка\n\n📞 Дополнительная информация: +998 97 827 55 77",
        контакты:
          "Наша контактная информация:\n\n📍 Адрес: г. Наманган, Янги Наманганский район\n📞 Телефон: +998 97 827 55 77\n📧 Email: info@piima.uz\n🌐 Сайт: www.piima.uz\n\n🕒 Рабочее время: Пн-Пт 8:30-17:30",
        предметы:
          "У нас углубленное изучение следующих предметов:\n\n🔬 Точные науки:\n• Математика\n• Физика\n• Химия\n• Биология\n\n💻 Современные предметы:\n• Информатика\n• Робототехника\n• IT технологии",
        преимущества:
          "Преимущества нашей школы:\n\n🏆 Качественное образование\n🌟 Квалифицированные учителя\n💻 Современное оборудование\n🎯 Индивидуальный подход\n🏅 Подготовка к олимпиадам\n🌍 Международные связи",
        default:
          "Извините, не могу дать точный ответ на этот вопрос. 😔\n\nДля дополнительной информации:\n📞 +998 97 827 55 77\n📧 info@piima.uz\n\nИли задайте другой вопрос! 😊",
      },
      en: {
        hello: "Hello! Welcome to PIIMA school! 🎓",
        "about school":
          "PIIMA - Agency of Specialized Educational Institutions. We provide quality education for talented students. 📚\n\n🏫 We have:\n• Presidential schools\n• Creative schools\n• Specialized schools\n\nDetailed information on our website!",
        admission:
          "Admission information:\n\n📅 Application period: May-June each year\n📝 Required documents:\n• Application\n• Passport copy\n• Diploma/certificate\n• Medical certificate\n\n📞 Additional info: +998 97 827 55 77",
        contact:
          "Our contact information:\n\n📍 Address: Namangan city, Yangi Namangan district\n📞 Phone: +998 97 827 55 77\n📧 Email: info@piima.uz\n🌐 Website: www.piima.uz\n\n🕒 Working hours: Mon-Fri 8:30-17:30",
        subjects:
          "We provide in-depth education in:\n\n🔬 Exact sciences:\n• Mathematics\n• Physics\n• Chemistry\n• Biology\n\n💻 Modern subjects:\n• Computer Science\n• Robotics\n• IT Technologies",
        advantages:
          "Our school advantages:\n\n🏆 Quality education\n🌟 Qualified teachers\n💻 Modern equipment\n🎯 Individual approach\n🏅 Olympiad preparation\n🌍 International connections",
        default:
          "Sorry, I cannot give an exact answer to this question. 😔\n\nFor additional information:\n📞 +998 97 827 55 77\n📧 info@piima.uz\n\nOr ask another question! 😊",
      },
    }

    this.init()
  }

  init() {
    this.bindEvents()
    this.showWelcomeMessage()
    this.updateLanguage()
  }

  bindEvents() {
    // Chat toggle
    document.getElementById("chat-toggle").addEventListener("click", () => {
      this.toggleChat()
    })

    // Chat controls
    document.getElementById("chat-close").addEventListener("click", () => {
      this.closeChat()
    })

    document.getElementById("chat-minimize").addEventListener("click", () => {
      this.minimizeChat()
    })

    // Message sending
    document.getElementById("send-message").addEventListener("click", () => {
      this.sendMessage()
    })

    document.getElementById("message-input").addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        this.sendMessage()
      }
    })

    // Quick actions
    document.querySelectorAll(".quick-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const message = btn.getAttribute("data-message")
        this.sendQuickMessage(message)
      })
    })

    // Language switching
    document.querySelectorAll(".lang-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const lang = btn.getAttribute("data-lang")
        this.switchLanguage(lang)
      })
    })

    // Show language selector on long press
    let longPressTimer
    document.getElementById("chat-toggle").addEventListener("mousedown", () => {
      longPressTimer = setTimeout(() => {
        this.showLanguageSelector()
      }, 1000)
    })

    document.getElementById("chat-toggle").addEventListener("mouseup", () => {
      clearTimeout(longPressTimer)
    })

    // Hide language selector when clicking outside
    document.addEventListener("click", (e) => {
      if (!e.target.closest(".chat-lang-selector") && !e.target.closest("#chat-toggle")) {
        this.hideLanguageSelector()
      }
    })
  }

  toggleChat() {
    const chatWindow = document.getElementById("chat-window")
    const chatToggle = document.getElementById("chat-toggle")
    const notification = document.getElementById("chat-notification")

    if (this.isOpen) {
      this.closeChat()
    } else {
      chatWindow.classList.add("show")
      chatToggle.classList.add("active")
      notification.style.display = "none"
      this.isOpen = true
      this.isMinimized = false

      // Focus input
      setTimeout(() => {
        document.getElementById("message-input").focus()
      }, 300)
    }
  }

  closeChat() {
    const chatWindow = document.getElementById("chat-window")
    const chatToggle = document.getElementById("chat-toggle")

    chatWindow.classList.remove("show")
    chatToggle.classList.remove("active")
    this.isOpen = false
    this.isMinimized = false
  }

  minimizeChat() {
    const chatWindow = document.getElementById("chat-window")

    if (this.isMinimized) {
      chatWindow.classList.remove("minimized")
      this.isMinimized = false
    } else {
      chatWindow.classList.add("minimized")
      this.isMinimized = true
    }
  }

  sendMessage() {
    const input = document.getElementById("message-input")
    const message = input.value.trim()

    if (!message) return

    this.addMessage(message, "user")
    input.value = ""

    // Show typing indicator
    this.showTypingIndicator()

    // Simulate AI response delay
    setTimeout(
      () => {
        this.hideTypingIndicator()
        const response = this.getAIResponse(message)
        this.addMessage(response, "bot")
      },
      1000 + Math.random() * 2000,
    )
  }

  sendQuickMessage(message) {
    this.addMessage(message, "user")

    setTimeout(() => {
      const response = this.getAIResponse(message)
      this.addMessage(response, "bot")
    }, 500)
  }

  addMessage(text, sender) {
    const messagesContainer = document.getElementById("chat-messages")
    const messageDiv = document.createElement("div")
    messageDiv.className = `message ${sender}`

    if (sender === "bot") {
      messageDiv.innerHTML = `
                <div class="bot-avatar-small">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">${text}</div>
            `
    } else {
      messageDiv.innerHTML = `
                <div class="message-content">${text}</div>
            `
    }

    messagesContainer.appendChild(messageDiv)
    messagesContainer.scrollTop = messagesContainer.scrollHeight

    // Store message in history
    this.messageHistory.push({ text, sender, timestamp: Date.now() })
  }

  showTypingIndicator() {
    const messagesContainer = document.getElementById("chat-messages")
    const typingDiv = document.createElement("div")
    typingDiv.className = "message bot typing-message"
    typingDiv.innerHTML = `
            <div class="bot-avatar-small">
                <i class="fas fa-robot"></i>
            </div>
            <div class="typing-indicator">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        `

    messagesContainer.appendChild(typingDiv)
    messagesContainer.scrollTop = messagesContainer.scrollHeight
  }

  hideTypingIndicator() {
    const typingMessage = document.querySelector(".typing-message")
    if (typingMessage) {
      typingMessage.remove()
    }
  }

  getAIResponse(message) {
    const lowerMessage = message.toLowerCase()
    const responses = this.responses[this.currentLang]

    // Check for specific keywords
    for (const key in responses) {
      if (key !== "default" && lowerMessage.includes(key)) {
        return responses[key]
      }
    }

    // Check for common greetings
    const greetings = ["salom", "hello", "привет", "hi", "assalomu alaykum"]
    if (greetings.some((greeting) => lowerMessage.includes(greeting))) {
      return responses["salom"] || responses["hello"] || responses["привет"]
    }

    // Check for school-related keywords
    const schoolKeywords = ["maktab", "school", "школа", "ta'lim", "образование", "education"]
    if (schoolKeywords.some((keyword) => lowerMessage.includes(keyword))) {
      return responses["maktab haqida"] || responses["about school"] || responses["о школе"]
    }

    // Check for admission keywords
    const admissionKeywords = ["qabul", "admission", "поступление", "kirish", "enter"]
    if (admissionKeywords.some((keyword) => lowerMessage.includes(keyword))) {
      return responses["qabul"] || responses["admission"] || responses["поступление"]
    }

    // Check for contact keywords
    const contactKeywords = ["aloqa", "contact", "контакт", "telefon", "phone", "телефон"]
    if (contactKeywords.some((keyword) => lowerMessage.includes(keyword))) {
      return responses["bog'lanish"] || responses["contact"] || responses["контакты"]
    }

    return responses["default"]
  }

  showWelcomeMessage() {
    setTimeout(() => {
      const welcomeMessage = this.translations[this.currentLang]["welcome-message"]
      this.addMessage(welcomeMessage, "bot")
    }, 1000)
  }

  switchLanguage(lang) {
    this.currentLang = lang
    this.updateLanguage()
    this.updateActiveLanguage()
    this.hideLanguageSelector()
  }

  updateLanguage() {
    const elements = document.querySelectorAll("[data-key]")
    elements.forEach((element) => {
      const key = element.getAttribute("data-key")
      if (this.translations[this.currentLang] && this.translations[this.currentLang][key]) {
        element.textContent = this.translations[this.currentLang][key]
      }
    })

    // Update placeholder
    const input = document.getElementById("message-input")
    if (input) {
      input.placeholder = this.translations[this.currentLang]["chat-placeholder"]
    }
  }

  updateActiveLanguage() {
    document.querySelectorAll(".lang-btn").forEach((btn) => {
      btn.classList.toggle("active", btn.getAttribute("data-lang") === this.currentLang)
    })
  }

  showLanguageSelector() {
    document.getElementById("chat-lang-selector").classList.add("show")
  }

  hideLanguageSelector() {
    document.getElementById("chat-lang-selector").classList.remove("show")
  }
}

// Initialize chat widget when DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
  new PIIMAChatWidget()
})







// news





        // Global variables
        let allNews = [];
        let filteredNews = [];
        let currentPage = 1;
        const newsPerPage = 6;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadNews();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', debounce(filterNews, 300));
            document.getElementById('categoryFilter').addEventListener('change', filterNews);
            document.getElementById('sortFilter').addEventListener('change', filterNews);
        }

        // Load news from localStorage (admin panel data)
        function loadNews() {
            showLoading();
            
            // Simulate loading delay
            setTimeout(() => {
                // Get news from localStorage (same as admin panel)
                const newsData = localStorage.getItem('news');
                if (newsData) {
                    allNews = JSON.parse(newsData).filter(news => news.published);
                } else {
                    // Sample data if no admin data exists
                    allNews = getSampleNews();
                }
                
                filteredNews = [...allNews];
                displayFeaturedNews();
                displayNews();
                hideLoading();
            }, 500);
        }

        // Sample news data
        function getSampleNews() {
            return [
                {
                    id: 1,
                    title: "Yangi ta'lim dasturi ishga tushirildi",
                    content: "Maktablarda yangi ta'lim dasturi joriy etilmoqda. Bu dastur zamonaviy texnologiyalar va innovatsion yondashuvlarni o'z ichiga oladi. Dastur barcha yoshdagi o'quvchilar uchun mo'ljallangan va kelajakda ta'lim sifatini oshirishga qaratilgan.",
                    category: "talim",
                    author: "Administrator",
                    date: new Date().toISOString(),
                    views: 156,
                    image: "/placeholder.svg?height=200&width=400",
                    published: true
                },
                {
                    id: 2,
                    title: "Sport musobaqalari e'lon qilindi",
                    content: "Yillik sport musobaqalari uchun ro'yxatdan o'tish boshlandi. Barcha yoshdagi ishtirokchilar qatnashishlari mumkin. Musobaqalar kelgusi oy o'tkaziladi va turli sport turlarini qamrab oladi.",
                    category: "sport",
                    author: "Administrator",
                    date: new Date(Date.now() - 86400000).toISOString(),
                    views: 89,
                    image: "/placeholder.svg?height=200&width=400",
                    published: true
                },
                {
                    id: 3,
                    title: "Madaniy tadbirlar haftaligi",
                    content: "Kelgusi hafta madaniy tadbirlar haftaligi o'tkaziladi. Konsertlar, ko'rgazmalar va boshqa qiziqarli tadbirlar kutilmoqda. Barcha aholini taklif qilamiz va bepul kirish imkoniyati mavjud.",
                    category: "tadbir",
                    author: "Administrator",
                    date: new Date(Date.now() - 172800000).toISOString(),
                    views: 234,
                    image: "/placeholder.svg?height=200&width=400",
                    published: true
                },
                {
                    id: 4,
                    title: "Yangi texnologiyalar seminari",
                    content: "IT sohasidagi yangi texnologiyalar bo'yicha seminar o'tkaziladi. Mutaxassislar o'z tajribalarini bo'lishadi va zamonaviy dasturlash tillari haqida ma'lumot beradi.",
                    category: "texnologiya",
                    author: "Administrator",
                    date: new Date(Date.now() - 259200000).toISOString(),
                    views: 67,
                    image: "/placeholder.svg?height=200&width=400",
                    published: true
                },
                {
                    id: 5,
                    title: "Muhim e'lon: Yangi qoidalar",
                    content: "Barcha foydalanuvchilar uchun yangi qoidalar e'lon qilinadi. Iltimos, diqqat bilan o'qing va belgilangan muddatlarga rioya qiling.",
                    category: "elon",
                    author: "Administrator",
                    date: new Date(Date.now() - 345600000).toISOString(),
                    views: 445,
                    image: "/placeholder.svg?height=200&width=400",
                    published: true
                }
            ];
        }

        // Display featured news
        function displayFeaturedNews() {
            const featuredContainer = document.getElementById('featuredNews');
            if (filteredNews.length === 0) {
                featuredContainer.style.display = 'none';
                return;
            }

            const featuredNews = filteredNews[0]; // First news as featured
            featuredContainer.style.display = 'block';
            
            featuredContainer.innerHTML = `
                <div class="featured-card">
                    <img src="${featuredNews.image}" alt="${featuredNews.title}" class="featured-image">
                    <div class="featured-content">
                        <span class="featured-badge">Asosiy yangilik</span>
                        <h2 class="featured-title">${featuredNews.title}</h2>
                        <p class="featured-excerpt">${truncateText(featuredNews.content, 150)}</p>
                        <div class="news-meta">
                            <span class="news-date">
                                <i class="fas fa-calendar"></i>
                                ${formatDate(featuredNews.date)}
                            </span>
                            <span class="news-views">
                                <i class="fas fa-eye"></i>
                                ${featuredNews.views} ko'rishlar
                            </span>
                        </div>
                        <a href="#" class="read-more" onclick="readMore(${featuredNews.id})">
                            Batafsil o'qish
                        </a>
                    </div>
                </div>
            `;
        }

        // Display news
        function displayNews() {
            const newsGrid = document.getElementById('newsGrid');
            const noResults = document.getElementById('noResults');
            
            if (filteredNews.length === 0) {
                newsGrid.style.display = 'none';
                noResults.style.display = 'block';
                document.getElementById('pagination').style.display = 'none';
                return;
            }

            newsGrid.style.display = 'grid';
            noResults.style.display = 'none';

            // Skip first news (featured)
            const newsToShow = filteredNews.slice(1);
            const startIndex = (currentPage - 1) * newsPerPage;
            const endIndex = startIndex + newsPerPage;
            const currentNews = newsToShow.slice(startIndex, endIndex);

            newsGrid.innerHTML = currentNews.map(news => `
                <div class="news-card">
                    <img src="${news.image}" alt="${news.title}" class="news-image">
                    <div class="news-content">
                        <span class="news-category category-${news.category}">
                            ${getCategoryIcon(news.category)} ${getCategoryName(news.category)}
                        </span>
                        <h3 class="news-title">${news.title}</h3>
                        <p class="news-excerpt">${truncateText(news.content, 120)}</p>
                        <a href="#" class="read-more" onclick="readMore(${news.id})">
                            Batafsil o'qish
                        </a>
                        <div class="news-meta">
                            <span class="news-date">
                                <i class="fas fa-calendar"></i>
                                ${formatDate(news.date)}
                            </span>
                            <span class="news-views">
                                <i class="fas fa-eye"></i>
                                ${news.views} ko'rishlar
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');

            displayPagination(newsToShow.length);
        }

        // Display pagination
        function displayPagination(totalNews) {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(totalNews / newsPerPage);

            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }

            pagination.style.display = 'flex';

            let paginationHTML = '';

            // Previous button
            paginationHTML += `
                <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;

            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage || i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    paginationHTML += `
                        <button onclick="changePage(${i})" ${i === currentPage ? 'class="active"' : ''}>
                            ${i}
                        </button>
                    `;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    paginationHTML += '<span>...</span>';
                }
            }

            // Next button
            paginationHTML += `
                <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;

            pagination.innerHTML = paginationHTML;
        }

        // Change page
        function changePage(page) {
            const totalNews = filteredNews.slice(1).length; // Exclude featured
            const totalPages = Math.ceil(totalNews / newsPerPage);
            
            if (page < 1 || page > totalPages) return;
            
            currentPage = page;
            displayNews();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function filterNews() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const sortBy = document.getElementById('sortFilter').value;

            filteredNews = allNews.filter(news => {
                const matchesSearch = news.title.toLowerCase().includes(searchTerm) || 
                                    news.content.toLowerCase().includes(searchTerm);
                const matchesCategory = !category || news.category === category;
                return matchesSearch && matchesCategory;
            });

            switch (sortBy) {
                case 'newest':
                    filteredNews.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'oldest':
                    filteredNews.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'popular':
                    filteredNews.sort((a, b) => b.views - a.views);
                    break;
            }

            currentPage = 1;
            displayFeaturedNews();
            displayNews();
        }

        // Read more function
        function readMore(newsId) {
            const news = allNews.find(n => n.id === newsId);
            if (news) {
                news.views++;
                localStorage.setItem('news', JSON.stringify(allNews));
                
                // Show full news (you can implement modal or redirect to detail page)
                showNewsModal(news);
            }
        }

        function showNewsModal(news) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
            `;

            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 15px;
                    max-width: 800px;
                    max-height: 90vh;
                    overflow-y: auto;
                    position: relative;
                ">
                    <button onclick="this.closest('div').remove()" style="
                        position: absolute;
                        top: 15px;
                        right: 15px;
                        background: none;
                        border: none;
                        font-size: 24px;
                        cursor: pointer;
                        z-index: 1001;
                        color: #666;
                    ">&times;</button>
                    
                    <img src="${news.image}" alt="${news.title}" style="
                        width: 100%;
                        height: 300px;
                        object-fit: cover;
                        border-radius: 15px 15px 0 0;
                    ">
                    
                    <div style="padding: 30px;">
                        <span class="news-category category-${news.category}" style="margin-bottom: 15px; display: inline-block;">
                            ${getCategoryIcon(news.category)} ${getCategoryName(news.category)}
                        </span>
                        
                        <h2 style="font-size: 1.8rem; margin-bottom: 15px; color: #2c3e50;">
                            ${news.title}
                        </h2>
                        
                        <div style="display: flex; gap: 20px; margin-bottom: 20px; color: #6c757d; font-size: 14px;">
                            <span><i class="fas fa-calendar"></i> ${formatDate(news.date)}</span>
                            <span><i class="fas fa-user"></i> ${news.author}</span>
                            <span><i class="fas fa-eye"></i> ${news.views} ko'rishlar</span>
                        </div>
                        
                        <div style="line-height: 1.8; color: #333; font-size: 16px;">
                            ${news.content}
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function getCategoryIcon(category) {
            const icons = {
                elon: '📢',
                tadbir: '🎉',
                talim: '🏫',
                sport: '⚽',
                texnologiya: '💻'
            };
            return icons[category] || '📰';
        }

        function getCategoryName(category) {
            const names = {
                elon: "E'lonlar",
                tadbir: 'Tadbirlar',
                talim: "Ta'lim",
                sport: 'Sport',
                texnologiya: 'Texnologiya'
            };
            return names[category] || 'Boshqa';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            };
            return date.toLocaleDateString('uz-UZ', options);
        }

        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substr(0, maxLength) + '...';
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('newsGrid').style.display = 'none';
            document.getElementById('featuredNews').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        setInterval(() => {
            const currentNewsData = localStorage.getItem('news');
            if (currentNewsData) {
                const newNews = JSON.parse(currentNewsData).filter(news => news.published);
                if (JSON.stringify(newNews) !== JSON.stringify(allNews)) {
                    allNews = newNews;
                    filterNews();
                }
            }
        }, 30000);
